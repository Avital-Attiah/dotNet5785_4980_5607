<Window x:Class="PL.Volunteer.VolunteerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:PL.Volunteer"
        xmlns:conv="clr-namespace:PL"
        Title="ניהול מתנדב" Width="700" Height="Auto"
        FlowDirection="RightToLeft" WindowStartupLocation="CenterScreen"
        Background="#DFF6FB"
        SizeToContent="Height">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <conv:NullToVisibilityConverter x:Key="NullToVisibilityConverter"/>
    </Window.Resources>

    <Border BorderBrush="#219EBC" BorderThickness="3" CornerRadius="10" Padding="10" Margin="10" Background="White">
        <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="600">
            <StackPanel>

                <!-- כותרת -->
                <TextBlock Text="פרטי מתנדב" FontSize="22" FontWeight="Bold" Foreground="#0077B6" Margin="0 0 0 10" TextAlignment="Center"/>

                <!-- טופס פרטי מתנדב -->
                <Grid Margin="0 0 0 20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <!-- Id -->
                        <RowDefinition Height="Auto"/>
                        <!-- Name -->
                        <RowDefinition Height="Auto"/>
                        <!-- Phone -->
                        <RowDefinition Height="Auto"/>
                        <!-- Email -->
                        <RowDefinition Height="Auto"/>
                        <!-- Address -->
                        <RowDefinition Height="Auto"/>
                        <!-- Password -->
                        <RowDefinition Height="Auto"/>
                        <!-- MaxDistance -->
                        <RowDefinition Height="Auto"/>
                        <!-- DistanceType -->
                        <RowDefinition Height="Auto"/>
                        <!-- Role -->
                        <RowDefinition Height="Auto"/>
                        <!-- IsActive -->
                    </Grid.RowDefinitions>

                    <Label Grid.Row="0" Grid.Column="0" Content="תעודת זהות:" Margin="5"/>
                    <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding Volunteer.Id}" IsEnabled="{Binding IsIdEnabled}" Margin="5"/>

                    <Label Grid.Row="1" Grid.Column="0" Content="שם מלא:" Margin="5"/>
                    <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Volunteer.FullName}" Margin="5"/>

                    <Label Grid.Row="2" Grid.Column="0" Content="טלפון:" Margin="5"/>
                    <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding Volunteer.Phone}" Margin="5"/>

                    <Label Grid.Row="3" Grid.Column="0" Content="דוא״ל:" Margin="5"/>
                    <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding Volunteer.Email}" Margin="5"/>

                    <Label Grid.Row="4" Grid.Column="0" Content="כתובת:" Margin="5"/>
                    <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding Volunteer.Address}" Margin="5"/>

                    <Label Grid.Row="5" Grid.Column="0" Content="סיסמה:" Margin="5"/>
                    <PasswordBox Grid.Row="5" Grid.Column="1" Margin="5"
             x:Name="PasswordBox"
             PasswordChanged="PasswordBox_PasswordChanged"/>


                    <Label Grid.Row="6" Grid.Column="0" Content="מרחק מרבי:" Margin="5"/>
                    <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding Volunteer.MaxCallDistance}" Margin="5"/>

                    <Label Grid.Row="7" Grid.Column="0" Content="סוג מרחק:" Margin="5"/>
                    <ComboBox Grid.Row="7" Grid.Column="1"
                              ItemsSource="{x:Static conv:DistanceTypesCollection.s_values}"
                              SelectedItem="{Binding Volunteer.DistanceType}" Margin="5"/>

                    <Label Grid.Row="8" Grid.Column="0" Content="תפקיד:" Margin="5"/>
                    <ComboBox Grid.Row="8" Grid.Column="1"
                              ItemsSource="{x:Static conv:RolesCollection.s_values}"
                              SelectedItem="{Binding Volunteer.Role}" Margin="5"
                              IsEnabled="{Binding IsRoleEditable}"/>

                    <Label Grid.Row="9" Grid.Column="0" Content="פעיל:" Margin="5"/>
                    <CheckBox Grid.Row="9" Grid.Column="1"
                              IsChecked="{Binding Volunteer.IsActive}"
                              IsEnabled="{Binding CanDeactivate}" Margin="5"/>
                </Grid>

                <!-- פרטי קריאה בטיפול -->
                <GroupBox Header="קריאה בטיפול" Margin="0 0 0 20"
                          Visibility="{Binding Volunteer.CurrentCall, Converter={StaticResource NullToVisibilityConverter}}">
                    <StackPanel Margin="10">
                        <TextBlock Text="סוג קריאה:" FontWeight="Bold"/>
                        <TextBlock Text="{Binding Volunteer.CurrentCall.CallType}" Margin="0 0 0 10"/>
                        <TextBlock Text="כתובת:" FontWeight="Bold"/>
                        <TextBox x:Name="txtAddress"
                                 Text="{Binding Volunteer.Address, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Margin="0 0 0 10"/>

                        <TextBlock Text="תיאור:" FontWeight="Bold"/>
                        <TextBlock Text="{Binding Volunteer.CurrentCall.Description}" Margin="0 0 0 10"/>

                        <TextBlock Text="נפתחה ב:" FontWeight="Bold"/>
                        <TextBlock Text="{Binding Volunteer.CurrentCall.OpeningTime}" Margin="0 0 0 10"/>

                        <TextBlock Text="סטטוס:" FontWeight="Bold"/>
                        <TextBlock Text="{Binding Volunteer.CurrentCall.Status}" Margin="0 0 0 10"/>
                    </StackPanel>
                </GroupBox>

                <!-- כפתורים -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0 0 0 10">
                    <Button Content="{Binding ButtonText}" Click="btnAddUpdate_Click" Margin="5" Padding="10 5"/>
                    <Button Content="ביטול" Click="btnCancel_Click" Margin="5" Padding="10 5"/>
                    <Button Content="סיים טיפול" Click="btnCompleteCall_Click" Margin="5" Padding="10 5"
                            Visibility="{Binding Volunteer.CurrentCall, Converter={StaticResource NullToVisibilityConverter}}"/>
                    <Button Content="בטל טיפול" Click="btnCancelCall_Click" Margin="5" Padding="10 5"
                            Visibility="{Binding Volunteer.CurrentCall, Converter={StaticResource NullToVisibilityConverter}}"/>
                </StackPanel>

            </StackPanel>
        </ScrollViewer>
    </Border>
</Window>
